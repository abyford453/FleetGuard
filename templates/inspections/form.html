{% extends "base.html" %}
{% block page_title %}
  {% if mode == "create" %}{% if can_assign %}Assign Inspection{% else %}New Inspection{% endif %}{% elif mode == "edit" %}Inspection{% else %}Delete Inspection{% endif %}
{% endblock %}
{% block page_subtitle %}{% endblock %}
{% block content %}

<style>
  .panel{background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.10);border-radius:18px;padding:16px;box-shadow:0 12px 34px rgba(0,0,0,.25);max-width:980px;}
  .grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px;}
  .grid .full{grid-column:1 / -1;}
  label{display:block;font-size:12px;letter-spacing:.08em;text-transform:uppercase;opacity:.75;margin-bottom:6px;}
  input,select,textarea{width:100%;}
  .section{margin-top:16px;padding-top:14px;border-top:1px solid rgba(255,255,255,.10);}
  .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px;}
  .btn{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:12px;border:1px solid rgba(255,255,255,.12);text-decoration:none;}
  .btn.primary{border-color:rgba(37,214,255,.35);}
  .btn.danger{border-color:rgba(255,80,80,.35);}
  .muted{opacity:.70;}
  @media (max-width: 800px){ .grid{grid-template-columns:1fr;} }
</style>

<div class="panel">
  {% if mode == "delete" %}
    <p>Are you sure you want to delete this inspection?</p>
    <p class="muted"><strong>{{ obj.inspection_date }}</strong> — {{ obj.vehicle }} — {{ obj.get_status_display }}</p>

    <form method="post">
      {% csrf_token %}
      <div class="actions">
        <button class="btn danger" type="submit">Yes, Delete</button>
        <a class="btn" href="{% url 'inspections:list' %}">Cancel</a>
      </div>
    </form>
  {% else %}
    <form method="post">
      {% csrf_token %}

      <div class="grid">
        <div>
          <label for="{{ form.vehicle.id_for_label }}">Vehicle</label>
          {{ form.vehicle }}
        </div>

        <div>
          <label for="{{ form.inspection_date.id_for_label }}">Inspection Date</label>
          {{ form.inspection_date }}
        </div>

        <div>
          <label for="{{ form.inspection_type.id_for_label }}">Inspection Type</label>
          {{ form.inspection_type }}
        </div>
      </div>

      {% if can_assign %}
        <div class="section">
          <div class="grid">
            <div>
              <label for="{{ form.assigned_to.id_for_label }}">Assigned To</label>
              {{ form.assigned_to }}
            </div>
            <div>
              <label for="{{ form.due_date.id_for_label }}">Due Date</label>
              {{ form.due_date }}
            </div>
            <div>
              <label for="{{ form.status.id_for_label }}">Status</label>
              {{ form.status }}
            </div>
          </div>
        </div>
      {% endif %}

      {% if can_complete %}
        <div class="section">
          <div class="grid">
            <div>
              <label for="{{ form.result.id_for_label }}">Result</label>
              {{ form.result }}
            </div>
            <div>
              <label for="{{ form.odometer.id_for_label }}">Odometer</label>
              {{ form.odometer }}
            </div>
            <div class="full">
              <label for="{{ form.notes.id_for_label }}">Notes</label>
              {{ form.notes }}
            </div>
          </div>
        </div>
      {% endif %}

      <div class="actions">
        <button class="btn primary" type="submit">
          {% if mode == "create" %}Save{% else %}Save Changes{% endif %}
        </button>
        <a class="btn" href="{% url 'inspections:list' %}">Cancel</a>
      </div>
    </form>
  {% endif %}
</div>

{% endblock %}
