{% extends "base.html" %}
{% block page_title %}Settings{% endblock %}
{% block page_subtitle %}Tenant-scoped configuration and access{% endblock %}

{% block content %}
<div class="card" style="margin-bottom:14px;">
  <div style="display:flex; justify-content:space-between; align-items:flex-start; gap:12px; flex-wrap:wrap;">
    <div>
      <div style="font-weight:850; font-size:16px; margin-bottom:4px;">
        Signed in as <span style="opacity:.9;">{{ user_display }}</span>
      </div>
      <div style="opacity:.85; font-size:13px;">
        {% if tenant %}
          Active tenant: <span style="font-weight:800;">{{ tenant.name }}</span>
          <span style="opacity:.7;">•</span>
          Your role:
          {% if is_admin %}
            <span class="badge">Admin</span>
          {% else %}
            <span class="badge badge-muted">User</span>
          {% endif %}
        {% else %}
          No active tenant selected.
        {% endif %}
      </div>
    </div>

    {% if tenant %}
      <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
        <span class="badge badge-muted">Members: {{ member_count }}</span>
        <span class="badge badge-muted">Admins: {{ admin_count }}</span>
      </div>
    {% endif %}
  </div>
</div>

<div class="grid" style="display:grid; gap:16px; grid-template-columns: repeat(12, 1fr);">
  {% for s in sections %}
    <section class="card" style="grid-column: span 12;">
      <div style="display:flex; justify-content:space-between; align-items:flex-start; gap:12px; flex-wrap:wrap;">
        <div style="min-width:240px;">
          <div style="font-weight:850; font-size:16px; margin-bottom:4px;">{{ s.title }}</div>
          <div style="opacity:.85; font-size:13px;">{{ s.desc }}</div>
        </div>

        <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
          {% if s.cta.enabled and s.cta.url %}
            <a class="btn" href="{{ s.cta.url }}">{{ s.cta.label }}</a>
          {% elif s.cta.label and s.cta.label != "—" %}
            <button class="btn btn-secondary" type="button" disabled aria-disabled="true" title="{{ s.cta.hint|default:'Not enabled' }}">
              {{ s.cta.label }}
            </button>
          {% endif %}
          {% if s.cta.hint %}
            <span style="opacity:.7; font-size:12px;">{{ s.cta.hint }}</span>
          {% endif %}
        </div>
      </div>

      <div style="margin-top:12px; overflow:auto;">
        <table class="table" style="width:100%;">
          <tbody>
            {% for it in s.items %}
              <tr>
                <td style="width:220px; opacity:.8;">{{ it.label }}</td>
                <td style="font-weight:700;">{{ it.value }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </section>
  {% endfor %}
</div>
{% endblock %}
