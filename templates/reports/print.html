<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>FleetGuard Executive Report</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root{
      --bg:#ffffff;
      --text:#111;
      --muted:#444;
      --border:#ddd;
      --panel:#f7f7f9;
      --radius:14px;
    }
    body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;}
    .wrap{max-width:1000px;margin:24px auto;padding:0 16px;}
    .top{display:flex;justify-content:space-between;align-items:flex-start;gap:12px;margin-bottom:14px;}
    .brand{font-weight:950;font-size:20px;}
    .sub{color:var(--muted);font-size:13px;line-height:1.35;}
    .btn{border:1px solid var(--border);background:white;border-radius:10px;padding:8px 12px;cursor:pointer;}
    .grid{display:grid;grid-template-columns:repeat(12,minmax(0,1fr));gap:12px;}
    .card{grid-column:span 4;background:var(--panel);border:1px solid var(--border);border-radius:var(--radius);padding:12px;min-height:96px;}
    .k{font-size:11px;letter-spacing:.08em;text-transform:uppercase;color:var(--muted);}
    .v{font-size:26px;font-weight:900;margin-top:6px;}
    .section{margin-top:14px;}
    .panel{background:var(--panel);border:1px solid var(--border);border-radius:var(--radius);padding:12px;}
    table{width:100%;border-collapse:collapse;}
    th,td{padding:8px;border-bottom:1px solid var(--border);text-align:left;vertical-align:top;font-size:13px;}
    th{color:var(--muted);font-size:11px;text-transform:uppercase;letter-spacing:.08em;}
    @media print{
      .noprint{display:none !important;}
      body{background:white;}
      .wrap{margin:0;max-width:none;}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div>
        <div class="brand">FleetGuard — Executive Report</div>
        <div class="sub">Tenant snapshot • Generated: {{ today }}</div>
      </div>
      <div class="noprint">
        <button class="btn" onclick="window.print()">Print / Save as PDF</button>
      </div>
    </div>

    <div class="grid">
      <div class="card"><div class="k">Vehicles</div><div class="v">{{ vehicle_count }}</div></div>
      <div class="card"><div class="k">Open Inspection Alerts</div><div class="v">{{ open_alerts }}</div></div>
      <div class="card"><div class="k">Overdue Inspections</div><div class="v">{{ overdue_inspections }}</div></div>
      <div class="card"><div class="k">Due Soon (7 days)</div><div class="v">{{ due_soon_inspections }}</div></div>
      <div class="card"><div class="k">Expired Documents</div><div class="v">{{ expired_docs }}</div></div>
      <div class="card"><div class="k">Expiring Documents (30 days)</div><div class="v">{{ expiring_docs }}</div></div>
      <div class="card"><div class="k">Fuel: Missing / Stale Logs (30 days)</div><div class="v">{{ fuel_stale_count }}</div></div>
      <div class="card"><div class="k">Fuel: Odometer Issues</div><div class="v">{{ fuel_odo_alert_count }}</div></div>
      <div class="card"><div class="k">Fuel Spend (30 days)</div><div class="v">${{ spend_30|floatformat:2 }}</div></div>
    </div>

    <div class="section panel">
      <div style="font-weight:900;margin-bottom:8px;">Top Vehicles by Fuel Spend (Last 90 Days)</div>
      {% if top_rows %}
        <table>
          <thead>
            <tr><th>Vehicle</th><th>Spend ($)</th></tr>
          </thead>
          <tbody>
            {% for name, total in top_rows %}
              <tr><td>{{ name }}</td><td>${{ total|floatformat:2 }}</td></tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <div class="sub">No fuel cost data available for the last 90 days.</div>
      {% endif %}
    </div>

    <div class="section noprint sub">
      Tip: In the print dialog, choose “Save as PDF” to generate a shareable report.
    </div>
  </div>
</body>
</html>
